GAME.addScreen("act",function(){that={};var heading,title;var mousePressed;var soundtrack;var h,t,next,sound;function startSoundtrack(){soundtrack=new Howl({urls:sound,loop:true}).fadeIn(.5,5e3)}that.init=function(){GAME.stage.setBackgroundColor(1052688);title=GAME.hudManager.addHud("hud-actTitle",GAME.renderer.width-30,125,0,130,"title");heading=GAME.hudManager.addHud("hud-act",GAME.renderer.width-30,30,0,100,"act");switch(GAME.STATE.act){case 2:h="";t="Fin";next="zone7";break;case 1:h="";t="The Zone";next="zone1";sound=["sound/ambient.mp3","sound/ambient.ogg"];break;default:h="A minimalist adventure";t="Stalker";next="prezone1";sound=["sound/ambient.mp3","sound/ambient.ogg"];break}if(sound){if(soundtrack){console.log(soundtrack);soundtrack.fadeOut(0,300,startSoundtrack)}else{startSoundtrack()}}heading.textContent=heading.innerText=h;title.textContent=title.innerText=t;if(next){setTimeout(function(){mousePressed=INPUT.addCallback("onmousedown",function(){INPUT.removeCallback("onmousedown",mousePressed);GAME.showScreen(next)})},3e3)}},that.exit=function(){};return that}());GAME.addScreen("boat",function(){var descriptions={};that={background:{img:"img/boat.png"},sprites:[],hotspots:[]};var storyLines={start:{exit:1},1:{line:"The boat seems to have been stranded here.",exit:2},2:{line:"Much like yourself.",exit:22},22:{exit:3},3:{line:"You remember having a boat once. One you used to take for a ride with your wife and daughter every June.",exit:4},4:{line:"You remember your wife is dead.",exit:5},5:{line:"You remember she died while pregnant.",exit:6},6:{line:"You remember who got her killed..."}};that.init=function(){GAME.showStory(storyLines,function(){GAME.showScreen("zone5")})};that.animate=function(){};that.exit=function(){};function debug(){}return that}());GAME.addScreen("eggs",function(){var descriptions={};that={background:{img:"img/eggs.png"},sprites:[],hotspots:[]};var storyLines={start:{line:"These artifacts are egg shaped and give off a very strong odor.",exit:1},1:{line:"These artifacts are egg shaped and give off a very strong odor.",exit:2},2:{line:"Much like yourself.",exit:3},3:{line:"There is no telling if these were laid by an animal or made otherwise.",exit:4},4:{line:"They are too heavy to carry with you, so you make a mental note to pick them up on your way back. They might very well be worth something on the black market."}};that.init=function(){GAME.showStory(storyLines,function(){GAME.showScreen("zone5")})};that.animate=function(){};that.exit=function(){};function debug(){}return that}());GAME.addScreen("postbox",function(){var wifeDialogue={start:{exit:1},1:{line:"I'm so worried",exit:2,div:"hud-dialogue"},2:{line:"You have changed since you started going to the Zone.",exit:3,div:"hud-dialogue"},3:{line:"It's not worth it. We can find another way to pay for my treatments.",exit:4,div:"hud-dialogue"},4:{line:"Please stay...",exit:4,div:"hud-dialogue",exit:5},5:{line:"... I promise I won't fail you again.",exit:6,div:"hud-dialogue"},6:{line:"... I promise I won't have another miscarriage.",div:"hud-dialogue",pre:function(){GAME.PLAYER.hasReadLetter=true}}};var descriptions={sign:{start:{exit:1},1:{line:"The sign is blank."}},letter:{start:{exit:1},1:{line:"There is a blank sheet of paper inside.",options:[2,3]},2:{line:"Put it back.",exit:21},21:{line:"This is absurd."},3:{line:"Read it anyway",exit:31},31:{line:"You stare at the letter",exit:32,pre:function(){GAME.PLAYER.readsLetter=true}},32:{line:"...",exit:33},33:{line:"You can see it now.",exit:34},34:{line:"It's a letter from your wife.",exit:35},35:{line:"Your dead wife..."}},button:{start:{exit:1},1:{line:"The button looks ominous.",options:[2,3]},2:{line:"Leave it alone."},3:{line:"Push it.",exit:31},31:{line:"You push the button.",exit:32,pre:function(){GAME.STATE.buttonPressed=true}},32:{line:"Nothing happens.",exit:33},33:{line:"Seemingly."}}};that={background:{img:"img/postbox.png"},sprites:[],hotspots:[{top:{x:530,y:180},bottom:{x:610,y:194},callback:function(){GAME.showStory(descriptions.sign)}},{top:{x:485,y:105},bottom:{x:627,y:162},callback:function(){GAME.showStory(descriptions.letter,function(){if(GAME.PLAYER.readsLetter){GAME.showDialogue(wifeDialogue,"img/wife.png");GAME.PLAYER.readsLetter=false}})}},{top:{x:380,y:148},bottom:{x:415,y:178},callback:function(){GAME.showStory(descriptions.button)}},{top:{x:0,y:260},bottom:{x:1024,y:400},title:"Exit to back entrance",callback:function(){GAME.showScreen("zone3")}}]};that.init=function(){GAME.setActive()};that.animate=function(){};that.exit=function(){};function debug(){}return that}());GAME.addScreen("prezone1",function(){var dialogue,dialogueDiv;var wifeSprite;var descriptions={bridge:{start:{exit:1},1:{line:"This bridge is your only chance of getting into the Zone. It has been kept open as part of outgoing transports for a covert military project. Which is also why you are here today. To your left is the pathway to the train tracks on the bridge."}},city:{start:{exit:1},1:{line:"Most of Stockholm was shut down after the Visitation. It is no longer what it used to be."}},water:{start:{exit:1},1:{line:"The water in Stockholm was among the cleanest in the world. One could take a sip of it without becoming sick. Unfortunately it has become deadly poisonous (and slightly brownish). Don't drink it."}},properGoodbye:{start:{exit:1},1:{line:"You should probably say your farewells. Make sure you've said everything that is important to her before leaving."}}};that={background:{img:"img/pre-zone1.png",scrollin:"left"},sprites:["img/wife.png"],hotspots:[{top:{x:0,y:0},bottom:{x:150,y:400},title:"Exit to the Zone",callback:function(){if(GAME.PLAYER.talkedToWife){GAME.STATE.act=1;GAME.showScreen("act")}else{GAME.showStory(descriptions.properGoodbye)}}},{top:{x:500,y:60},bottom:{x:900,y:260},callback:function(){GAME.showStory(descriptions.bridge)}},{top:{x:920,y:220},bottom:{x:1024,y:270},callback:function(){GAME.showStory(descriptions.city)}},{top:{x:720,y:280},bottom:{x:1024,y:380},callback:function(){GAME.showStory(descriptions.water)}},{top:{x:180,y:185},bottom:{x:325,y:400},callback:function(){GAME.showDialogue(wifeDialogue,"img/wife.png")}}]};var storyLines={start:{line:"The pre-zone.Your palms are sweaty and your heart is racing. But you need the money.",exit:1},1:{line:"Laid out in front of you is the only way into the Zone: the freightway. Since the incident, all other passages have either been permanently blocked or are heavily guarded by armed military personnel.",exit:2},2:{line:"Your wife is here to say farewell. This might very well be the very last time you ever see her."}};var wifeLines={start:{line:"Be careful out there.",exit:1},1:{line:"Please...",exit:2},2:{line:"come back alive."}};var wifeDialogue={start:{exit:1},1:{line:"I'm so worried",exit:10,div:"hud-dialogue"},10:{options:[11,12,13,14],div:"hud-character"},11:{line:"Ask about last night",exit:111,condition:function(){return!GAME.PLAYER.knows.lastNight},div:"hud-character"},111:{line:"What about it?",options:[1111,1112],div:"hud-dialogue"},1111:{line:"Nevermind...",div:"hud-character",exit:10},1112:{line:"Apologize",div:"hud-character",exit:11112},11112:{line:"It's ok. I know it wasn't your fault.",div:"hud-dialogue",exit:10,pre:function(){GAME.PLAYER.knows.lastNight=true}},12:{line:"Ask about daughter",exit:121,div:"hud-character",condition:function(){return GAME.PLAYER.knows.lastNight}},121:{line:"Mika is sick. She needs you.",exit:10,div:"hud-dialogue",pre:function(){GAME.PLAYER.talkedToWife=true}},13:{line:"Ask about the Zone",exit:131,div:"hud-character"},131:{line:"Last time you went in there, you came back with nothing.",exit:132,div:"hud-dialogue"},132:{line:"I wouldn't let you go in there if it wasn't for Mika. She really needs you now. Don't fail her.",exit:10,div:"hud-dialogue"},14:{line:"Leave for the Zone",div:"hud-character"},31:{line:"Your wife gets annoyed with you and turns away."}};that.init=function(){GAME.showStory(storyLines,function(){})};that.animate=function(){};that.exit=function(){};function debug(){}return that}());GAME.addScreen("zone1",function(){var descriptions={train:{start:{exit:1},1:{line:"These carts are old as dirt. I wonder what they carry with them on their way out of the Zone."}},city:{start:{exit:1},1:{line:"Whoever was left in the city after the Visitation is surely not alive any longer."}},water:{start:{exit:1},1:{line:"The water is fizzing. It is partly Witch's Jelly. If one were to take a bath, instant loss of limbs would be to expect."}},exit:{start:{exit:1},1:{line:"This way leads to the heavily guarderd walls surrounding the Zone."}},notReady:{start:{exit:1},1:{line:"There is a pathway down to the water, but you really should try to get into that military complex first."}}};that={background:{img:"img/zone1.png"},sprites:[],hotspots:[{top:{x:800,y:0},bottom:{x:1024,y:400},title:"Exit to the gate",callback:function(){if(GAME.PLAYER.knows.zoneExit1){GAME.showScreen("zone2")}else{GAME.showStory(descriptions.exit);GAME.PLAYER.knows.zoneExit1=true}}},{top:{x:375,y:50},bottom:{x:585,y:340},callback:function(){GAME.showStory(descriptions.train)}},{top:{x:0,y:160},bottom:{x:170,y:220},callback:function(){GAME.showStory(descriptions.city)}},{top:{x:0,y:230},bottom:{x:200,y:320},callback:function(){GAME.showStory(descriptions.water)}},{top:{x:250,y:150},bottom:{x:350,y:330},title:"Exit to water",callback:function(){if(GAME.PLAYER.hasReadLetter){GAME.showScreen("zone5")}else{GAME.showStory(descriptions.notReady)}}}]};var storyLines={start:{line:"Your ride in on the train was far from comfortable. It was undercover though.",exit:1},1:{line:"These old train tracks are being used for transporting artefacts out of the zone. The military must have gotten information from the Institute about something important."}};that.init=function(){if(!GAME.STATE.hasVisitedZone1){GAME.STATE.hasVisitedZone1=true;GAME.showStory(storyLines,function(){})}else{GAME.setActive()}};that.animate=function(){};that.exit=function(){};function debug(){}return that}());GAME.addScreen("zone2",function(){var charSprite;var descriptions={turret:{start:{exit:1},1:{line:"An automated turret. Fuck around and be instantly killed."}},camera:{start:{exit:1},1:{line:"Cameras using image recognition techniques that feed data as input to the automated turrets. Andrei really doesn't have to lift a finger in case an uninvited guest needs to be taken care of."}},gates:{start:{exit:1},1:{line:"Electrified fences."}},backdrop:{start:{exit:1},1:{line:"On the other side of the gate you can make out the huge vegetation that has grown from ground zero. The Visitation created an eternal spring, with strange plants flowering all year around."}},booth:{start:{exit:1},1:{line:"That booth is probably were Andrei sits around all day and consumes all his 'gifts'. Vodka, cigars, perhaps even real meat made from animal flesh."}}};that={background:{img:"img/zone2.png"},sprites:["img/andrei2.png","img/andrei.png","img/andrei3.png"],hotspots:[{top:{x:840,y:220},bottom:{x:1024,y:400},callback:function(){GAME.showDialogue(dialogueLines3)}},{top:{x:100,y:320},bottom:{x:600,y:400},title:"Exit to the train tracks",callback:function(){GAME.showScreen("zone1")}},{top:{x:0,y:30},bottom:{x:80,y:400},title:"Exit to the back entrance",callback:function(){GAME.showScreen("zone3")}},{top:{x:220,y:30},bottom:{x:300,y:100},callback:function(){GAME.showStory(descriptions.turret)}},{top:{x:340,y:130},bottom:{x:380,y:160},callback:function(){GAME.showStory(descriptions.camera)}},{top:{x:500,y:70},bottom:{x:570,y:120},callback:function(){GAME.showStory(descriptions.camera)}},{top:{x:750,y:80},bottom:{x:820,y:310},callback:function(){GAME.showStory(descriptions.booth)}},{top:{x:100,y:190},bottom:{x:330,y:290},callback:function(){GAME.showStory(descriptions.gates)}},{top:{x:430,y:160},bottom:{x:530,y:260},callback:function(){GAME.showStory(descriptions.backdrop)}}]};var dialogueLines={start:{exit:1},1:{line:"Halt you scumbag or I will instantly gun you down.",exit:2,div:"hud-dialogue"},2:{line:"Did you press that button? Don't think you can come waltzing in here uninvited...",exit:3,div:"hud-dialogue"},3:{line:"... unless you come with gifts, old pal!",div:"hud-dialogue"}};var dialogueLines2={start:{exit:4},4:{line:"Andrei. Always as happy. ",div:"hud-character",exit:5},5:{line:"Must be the poisonous fumes in here. ",div:"hud-character"}};var dialogueLines3={start:{exit:1},1:{line:"So my friend, what do you have for me today?",options:[21,22,23],div:"hud-dialogue"},11:{line:"Anything else?",options:[21,22,2201,23],div:"hud-dialogue"},21:{line:"Some cigarettes",exit:211,div:"hud-character"},211:{line:"Don't you know that inhaling poisonous fumes is hazardous to your health?",exit:212,div:"hud-dialogue"},212:{line:"I kid! Give me one.",exit:11,div:"hud-dialogue"},22:{line:"Cash",exit:221,div:"hud-character",condition:function(){return!GAME.PLAYER.knows.andreisAttituteCash}},221:{line:"Unless you have a substantial amount for me, you better rethink.",exit:11,div:"hud-dialogue",pre:function(){GAME.PLAYER.knows.andreisAttituteCash=true}},23:{line:"Nothing",exit:231,div:"hud-character"},231:{line:"What kind of friend are you anyway?",div:"hud-dialogue"},2201:{line:"Cash",exit:222,div:"hud-character"},222:{line:"How much did you say you have?",options:[30,31],div:"hud-dialogue"},30:{line:"Alot",exit:301,div:"hud-character"},301:{line:"That's not what I hear.",exit:11,div:"hud-dialogue"},31:{line:"Not much",exit:32,div:"hud-character"},32:{line:"That's what I thought.",exit:33,div:"hud-dialogue"},33:{line:"Let me make you a deal instead.",options:[331,332],div:"hud-dialogue",pre:function(){GAME.PLAYER.knows.aboutDealWithAndrei=true}},331:{line:"Yes",exit:3311,div:"hud-character"},3311:{line:"What kind of deal are we talking about?",exit:3312,div:"hud-character"},3312:{line:"Friends share brotherly.",exit:3313,div:"hud-dialogue"},3313:{line:"Let's say that one friend was to find some very valuable artefact...",exit:3314,div:"hud-dialogue"},3314:{line:"perhaps even one that belongs to someone else. Like the Institute.",exit:3315,div:"hud-dialogue"},3315:{line:"Come to think of it, some might even refer to it as stealing a very valuable artefact.",exit:3316,div:"hud-dialogue"},3316:{line:"In that case the other friend would of course protect the first one.",exit:3317,div:"hud-dialogue"},3317:{line:"And if that other friend was in need of money, the first friend, whom he so brotherly protected...",exit:3318,div:"hud-dialogue"},3318:{line:"would of course share half of whatever price he got for the valuable artefact.",exit:3319,div:"hud-dialogue"},3319:{line:"Do we understand each other?",options:[3320,3321],div:"hud-dialogue"},3320:{line:"Yes",exit:33201,div:"hud-character"},33201:{line:"Good then. You may enter...",exit:33202,div:"hud-dialogue",pre:function(){GAME.PLAYER.dealWithAndrei=true}},33202:{line:"As soon as you have payed me 5000 credits upfront."},3321:{line:"No",exit:231,div:"hud-character"},332:{line:"No",exit:231,div:"hud-character"}};that.init=function(){if(!GAME.STATE.hasVisitedZone2){GAME.STATE.hasVisitedZone2=true;GAME.showDialogue(dialogueLines,"img/andrei2.png",function(){GAME.showDialogue(dialogueLines2,"img/andrei.png",function(){addAndrei()})})}else{addAndrei();GAME.setActive()}};function addAndrei(){charSprite=PIXI.Sprite.fromImage("img/andrei3.png");charSprite.anchor.x=charSprite.anchor.y=1;charSprite.position.x=1024;charSprite.position.y=400;GAME.stage.addChild(charSprite)}that.animate=function(){};that.exit=function(){GAME.stage.removeChild(charSprite)};function debug(){}return that}());GAME.addScreen("zone3",function(){var manhole;var descriptions={door:{start:{exit:1},1:{line:"The door is locked."}},stairs:{start:{exit:1},1:{line:"The steps are corroded."}},sign1:{start:{exit:1},1:{line:"The sign reads: 'Authorized personnel only.'"}},sign2:{start:{exit:1},1:{line:"The sign reads: 'To the laboratory.'",exit:2},2:{line:"Must have been there since before the Visitation. God knows what these facilities are used for nowadays."}},sign3:{start:{exit:1},1:{line:"The sign reads: 'Parkering forbjuden.'",exit:2},2:{line:"Too bad you never learnt Swedish. Then again, very few Swedish speaking people are alive any longer."}},windows:{start:{exit:1},1:{line:"The windows are enforced. And even if they weren't, they're too small to fit in. It would be impossible to get in to the building this way."}},postbox:{start:{exit:1},1:{line:"There is a postbox on the wall."}}};that={background:{img:"img/zone3.png"},sprites:[],hotspots:[{top:{x:525,y:75},bottom:{x:605,y:250},title:"Exit through the back door",callback:function(){GAME.showStory(descriptions.door)}},{top:{x:530,y:40},bottom:{x:610,y:70},callback:function(){GAME.showStory(descriptions.sign2)}},{top:{x:760,y:190},bottom:{x:790,y:215},callback:function(){GAME.showStory(descriptions.sign3)}},{top:{x:630,y:185},bottom:{x:690,y:210},callback:function(){GAME.showStory(descriptions.sign1)}},{top:{x:750,y:75},bottom:{x:875,y:140},callback:function(){GAME.showStory(descriptions.windows)}},{top:{x:950,y:120},bottom:{x:1024,y:400},title:"Exit to front gate",callback:function(){GAME.showScreen("zone2")}},{top:{x:900,y:198},bottom:{x:917,y:223},callback:function(){GAME.showStory(descriptions.postbox,function(){GAME.showScreen("postbox")})}}]};var storyLines={start:{line:"This seems to be a back entrance into what used to be the factory complex but now is a military one."}};that.init=function(){if(!GAME.STATE.hasVisitedZone3){GAME.STATE.hasVisitedZone3=true;GAME.showStory(storyLines,function(){})}else{GAME.setActive()}};that.animate=function(){};that.exit=function(){};function debug(){}return that}());GAME.addScreen("zone4",function(){var descriptions={};that={background:{img:"img/zone4.png"},sprites:[],hotspots:[]};var storyLines={start:{line:"These factories have been here since before the Visitation. For some reason they seem to still be active."}};that.init=function(){if(!GAME.STATE.hasVisitedZone4){GAME.STATE.hasVisitedZone4=true;GAME.showStory(storyLines,function(){})}else{GAME.setActive()}};that.animate=function(){};that.exit=function(){};function debug(){}return that}());GAME.addScreen("zone5",function(){var charEggs;var descriptions={tree:{start:{exit:1},1:{line:"The trees have lost all their leaves. They have gained some orange moss though."}}};that={background:{img:"img/zone5.png"},sprites:[],hotspots:[{top:{x:800,y:185},bottom:{x:855,y:225},callback:function(){GAME.showScreen("eggs")}},{top:{x:200,y:180},bottom:{x:310,y:220},callback:function(){GAME.showScreen("boat")}},{top:{x:530,y:150},bottom:{x:600,y:275},callback:function(){GAME.showStory(descriptions.tree)}},{top:{x:700,y:250},bottom:{x:1024,y:400},title:"Exit to train tracks",callback:function(){GAME.showScreen("zone1")}}]};var storyLines={start:{line:"These parts seem perfect for finding some Witch's Jelly. ",exit:1},1:{line:"These parts seem perfect for finding some Witch's Jelly. ",exit:2},2:{line:"That is not why you are here though.",exit:3},3:{line:"On your left hand side you see something that looks like a stranded boat."}};that.init=function(){if(!GAME.STATE.hasVisitedZone5){GAME.STATE.hasVisitedZone5=true;GAME.showStory(storyLines,function(){})}else{GAME.setActive()}charEggs=PIXI.Sprite.fromImage("img/eggs.png");charEggs.anchor.x=charEggs.anchor.y=1;charEggs.position.x=1024;charEggs.position.y=400};that.animate=function(){};that.exit=function(){};function debug(){}return that}());GAME.addScreen("zone6",function(){var descriptions={};that={background:{img:"img/zone6.png"},sprites:[],hotspots:[]};var storyLines={start:{line:"You are clearly not the first intruder in the Zone. Stalkers range from vandals, to pure bred bounty hunters...",exit:1},1:{line:"much like yourself."}};that.init=function(){if(!GAME.STATE.hasVisitedZone6){GAME.STATE.hasVisitedZone6=true;GAME.showStory(storyLines,function(){})}else{GAME.setActive()}};that.animate=function(){};that.exit=function(){};function debug(){}return that}());GAME.addScreen("zone7",function(){var descriptions={};that={background:{img:"img/zone7.png"},sprites:[],hotspots:[]};var storyLines={start:{line:"You decend down the dark staircase.",exit:1},1:{line:"The artefact you've been looking for is near at hand.",exit:2},2:{line:"Your wife is dead.",exit:3},3:{line:"Mika is dead.",exit:4},4:{line:"At the end of these steps you will find what makes it all worth it.",exit:5},5:{pre:function(){setTimeout(function(){GAME.STATE.act=3;GAME.showScreen("act")},5e3)}}};that.init=function(){GAME.showStory(storyLines,function(){})};that.animate=function(){};that.exit=function(){};function debug(){}return that}());