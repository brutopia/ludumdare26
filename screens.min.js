GAME.addScreen("act",function(){that={};var heading,title;var mousePressed;var soundtrack;that.init=function(){GAME.stage.setBackgroundColor(1052688);heading=GAME.hudManager.addHud("hud-act",GAME.renderer.width-30,30,0,100,"act");title=GAME.hudManager.addHud("hud-actTitle",GAME.renderer.width-30,125,0,130,"title");var h,t,next,sound;switch(GAME.STATE.act){case 2:h="";t="Fin";next="";break;case 1:h="Act I";t="The Stalker";next="zone1";sound=["sound/ambient.mp3","sound/ambient.ogg"];break;default:h="Prelude";t="Enter the Zone";next="prezone1";sound=["sound/ambient.mp3","sound/ambient.ogg"];break}if(sound){if(soundtrack){console.log(soundtrack);soundtrack.fadeOut(0,300,startSoundtrack)}else{startSoundtrack()}function startSoundtrack(){soundtrack=new Howl({urls:sound,loop:true}).fadeIn(.5,5e3)}}heading.textContent=heading.innerText=h;title.textContent=title.innerText=t;if(next){setTimeout(function(){mousePressed=INPUT.addCallback("onmousedown",function(){INPUT.removeCallback("onmousedown",mousePressed);GAME.showScreen(next)})},3e3)}},that.exit=function(){};return that}());GAME.addScreen("prezone1",function(){var dialogue,dialogueDiv;var wifeSprite;var descriptions={bridge:{start:{exit:1},1:{line:"This bridge is your only chance of getting into the Zone. It has been kept open as part of outgoing transports for a covert military project. Which is also why you are here today. To your left is the pathway to the train tracks on the bridge."}},city:{start:{exit:1},1:{line:"Most of Stockholm was shut down after the Visitation. It is no longer what it used to be."}},water:{start:{exit:1},1:{line:"The water in Stockholm was among the cleanest in the world. One could take a sip of it without becoming sick. Unfortunately it has become deadly poisonous (and slightly brownish). Don't drink it."}},properGoodbye:{start:{exit:1},1:{line:"You should probably say your farewells. Make sure you've said everything that is important to her before leaving."}}};that={title:"Neo-Stockholm: The DMZ",background:{img:"img/pre-zone1.png",scrollin:"left",title:"The Pre-Zone"},sprites:["img/wife.png"],hotspots:[{top:{x:0,y:0},bottom:{x:150,y:400},title:"Exit to the Zone",callback:function(){if(GAME.PLAYER.talkedToWife){GAME.STATE.act=1;GAME.showScreen("act")}else{GAME.showStory(descriptions.properGoodbye)}}},{top:{x:500,y:60},bottom:{x:900,y:260},callback:function(){GAME.showStory(descriptions.bridge)}},{top:{x:920,y:220},bottom:{x:1024,y:270},callback:function(){GAME.showStory(descriptions.city)}},{top:{x:720,y:280},bottom:{x:1024,y:380},callback:function(){GAME.showStory(descriptions.water)}},{top:{x:180,y:185},bottom:{x:325,y:400},callback:function(){GAME.showDialogue(wifeDialogue,"img/wife.png")}}]};var storyLines={start:{line:"The pre-zone.Your palms are sweaty and your heart is racing. But you need the money.",exit:1},1:{line:"Laid out in front of you is the only way into the Zone: the freightway. Since the incident, all other passages have either been permanently blocked or are heavily guarded by armed military personnel.",exit:2},2:{line:"Your wife is here to say farewell. This might very well be the very last time you ever see her."}};var wifeLines={start:{line:"Be careful out there.",exit:1},1:{line:"Please...",exit:2},2:{line:"come back alive."}};var wifeDialogue={start:{exit:1},1:{line:"I'm so worried",exit:10,div:"hud-dialogue"},10:{options:[11,12,13,14],div:"hud-character"},11:{line:"Ask about last night",exit:111,condition:function(){return!GAME.PLAYER.knows.lastNight},div:"hud-character"},111:{line:"What about it?",options:[1111,1112],div:"hud-dialogue"},1111:{line:"Nevermind...",div:"hud-character",exit:10},1112:{line:"Apologize",div:"hud-character",exit:11112},11112:{line:"It's ok. I know it wasn't your fault.",div:"hud-dialogue",exit:10,pre:function(){GAME.PLAYER.knows.lastNight=true}},12:{line:"Ask about daughter",exit:121,div:"hud-character",condition:function(){return GAME.PLAYER.knows.lastNight}},121:{line:"Mika is sick. She needs you.",exit:10,div:"hud-dialogue",pre:function(){GAME.PLAYER.talkedToWife=true}},13:{line:"Ask about the Zone",exit:131,div:"hud-character"},131:{line:"Last time you went in there, you came back with nothing.",exit:132,div:"hud-dialogue"},132:{line:"I wouldn't let you go in there if it wasn't for Mika. She really needs you now. Don't fail her.",exit:10,div:"hud-dialogue"},14:{line:"Leave for the Zone",div:"hud-character"},31:{line:"Your wife gets annoyed with you and turns away."}};that.init=function(){GAME.showStory(storyLines,function(){})};that.animate=function(){};that.exit=function(){};function debug(){}return that}());GAME.addScreen("zone1",function(){var descriptions={train:{start:{exit:1},1:{line:"These carts are old as dirt. I wonder what they carry with them on their way out of the Zone."}},city:{start:{exit:1},1:{line:"Whoever was left in the city after the Visitation is surely not alive any longer."}},water:{start:{exit:1},1:{line:"The water is fizzing. It is partly Witch's Jelly. If one were to take a bath, instant loss of limbs would be to expect."}},exit:{start:{exit:1},1:{line:"This way leads to the heavily guarderd walls surrounding the Zone."}}};that={title:"Zone 4312 - Contaminated Area",background:{img:"img/zone1.png"},sprites:[],hotspots:[{top:{x:800,y:0},bottom:{x:1024,y:400},title:"Exit to the gate",callback:function(){if(GAME.PLAYER.knows.zoneExit1){GAME.showScreen("zone2")}else{GAME.showStory(descriptions.exit);GAME.PLAYER.knows.zoneExit1=true}}},{top:{x:375,y:50},bottom:{x:585,y:340},callback:function(){GAME.showStory(descriptions.train)}},{top:{x:0,y:160},bottom:{x:170,y:220},callback:function(){GAME.showStory(descriptions.city)}},{top:{x:0,y:230},bottom:{x:200,y:320},callback:function(){GAME.showStory(descriptions.water)}}]};var storyLines={start:{line:"Your ride in on the train was far from comfortable. It was undercover though.",exit:1},1:{line:"These old train tracks are being used for transporting artefacts out of the zone. The military must have gotten information from the Institute about something important."}};that.init=function(){if(!GAME.STATE.hasVisitedZone1){GAME.STATE.hasVisitedZone1=true;GAME.showStory(storyLines,function(){})}else{GAME.setActive()}};that.animate=function(){};that.exit=function(){};function debug(){}return that}());GAME.addScreen("zone2",function(){var charSprite;var descriptions={turret:{start:{exit:1},1:{line:"An automated turret. Fuck around and be instantly killed."}},camera:{start:{exit:1},1:{line:"Cameras using image recognition techniques that feed data as input to the automated turrets. Andrei really doesn't have to lift a finger in case an uninvited guest needs to be taken care of."}},gates:{start:{exit:1},1:{line:"Electrified fences."}},backdrop:{start:{exit:1},1:{line:"On the other side of the gate you can make out the huge vegetation that has grown from ground zero. The Visitation created an eternal spring, with strange plants flowering all year around."}},booth:{start:{exit:1},1:{line:"That booth is probably were Andrei sits around all day and consumes all his 'gifts'. Vodka, cigars, perhaps even real meat made from animal flesh."}}};that={background:{img:"img/zone2.png"},sprites:["img/andrei2.png","img/andrei.png","img/andrei3.png"],hotspots:[{top:{x:840,y:220},bottom:{x:1024,y:400},callback:function(){GAME.showDialogue(dialogueLines3)}},{top:{x:0,y:320},bottom:{x:600,y:400},title:"Exit to the train tracks",callback:function(){GAME.showScreen("zone1")}},{top:{x:220,y:30},bottom:{x:300,y:100},callback:function(){GAME.showStory(descriptions.turret)}},{top:{x:340,y:130},bottom:{x:380,y:160},callback:function(){GAME.showStory(descriptions.camera)}},{top:{x:500,y:70},bottom:{x:570,y:120},callback:function(){GAME.showStory(descriptions.camera)}},{top:{x:750,y:80},bottom:{x:820,y:310},callback:function(){GAME.showStory(descriptions.booth)}},{top:{x:100,y:190},bottom:{x:330,y:290},callback:function(){GAME.showStory(descriptions.gates)}},{top:{x:430,y:160},bottom:{x:530,y:260},callback:function(){GAME.showStory(descriptions.backdrop)}}]};var dialogueLines={start:{exit:1},1:{line:"Halt you scumbag or I will instantly gun you down.",exit:2,div:"hud-dialogue"},2:{line:"Don't think you can come waltzing in here uninvited...",exit:3,div:"hud-dialogue"},3:{line:"... unless you come with gifts, old pal!",div:"hud-dialogue"}};var dialogueLines2={start:{exit:4},4:{line:"Andrei. Always as happy. ",div:"hud-character",exit:5},5:{line:"Must be the poisonous fumes in here. ",div:"hud-character"}};var dialogueLines3={start:{exit:1},1:{line:"So my friend, what do you have for me today?",options:[21,22,23],div:"hud-dialogue"},11:{line:"Anything else?",options:[21,22,2201,23],div:"hud-dialogue"},21:{line:"Some cigarettes",exit:211,div:"hud-character"},211:{line:"Don't you know that inhaling poisonous fumes is hazardous to your health?",exit:212,div:"hud-dialogue"},212:{line:"I kid! Give me one.",exit:11,div:"hud-dialogue"},22:{line:"Cash",exit:221,div:"hud-character",condition:function(){return!GAME.PLAYER.knows.andreisAttituteCash}},221:{line:"Unless you have a substantial amount for me, you better rethink.",exit:11,div:"hud-dialogue",pre:function(){GAME.PLAYER.knows.andreisAttituteCash=true}},23:{line:"Nothing",exit:231,div:"hud-character"},231:{line:"What kind of friend are you anyway?",div:"hud-dialogue"},2201:{line:"Cash",exit:222,div:"hud-character"},222:{line:"How much did you say you have?",options:[30,31],div:"hud-dialogue"},30:{line:"Alot",exit:301,div:"hud-character"},301:{line:"That's not what I hear.",exit:11,div:"hud-dialogue"},31:{line:"Not much",exit:32,div:"hud-character"},32:{line:"That's what I thought.",exit:33,div:"hud-dialogue"},33:{line:"Let me make you a deal instead.",options:[331,332],div:"hud-dialogue",pre:function(){GAME.PLAYER.knows.aboutDealWithAndrei=true}},331:{line:"Yes",exit:3311,div:"hud-character"},3311:{line:"What kind of deal are we talking about?",exit:3312,div:"hud-character"},3312:{line:"Friends share brotherly.",exit:3313,div:"hud-dialogue"},3313:{line:"Let's say that one friend was to find some very valuable artefact...",exit:3314,div:"hud-dialogue"},3314:{line:"perhaps even one that belongs to someone else. Like the Institute.",exit:3315,div:"hud-dialogue"},3315:{line:"Come to think of it, some might even refer to it as stealing a very valuable artefact.",exit:3316,div:"hud-dialogue"},3316:{line:"In that case the other friend would of course protect the first one.",exit:3317,div:"hud-dialogue"},3317:{line:"And if that other friend was in need of money, the first friend, whom he so brotherly protected...",exit:3318,div:"hud-dialogue"},3318:{line:"would of course share half of whatever price he got for the valuable artefact.",exit:3319,div:"hud-dialogue"},3319:{line:"Do we understand each other?",options:[3320,3321],div:"hud-dialogue"},3320:{line:"Yes",exit:33201,div:"hud-character"},33201:{line:"Good then. You may enter.",exit:33202,div:"hud-dialogue",pre:function(){GAME.PLAYER.dealWithAndrei=true}},33201:{pre:function(){GAME.STATE.act=2;GAME.showScreen("act")}},3321:{line:"No",exit:231,div:"hud-character"},332:{line:"No",exit:231,div:"hud-character"}};that.init=function(){if(!GAME.STATE.hasVisitedZone2){GAME.STATE.hasVisitedZone2=true;GAME.showDialogue(dialogueLines,"img/andrei2.png",function(){GAME.showDialogue(dialogueLines2,"img/andrei.png",function(){addAndrei()})})}else{addAndrei();GAME.setActive()}};function addAndrei(){charSprite=PIXI.Sprite.fromImage("img/andrei3.png");charSprite.anchor.x=charSprite.anchor.y=1;charSprite.position.x=1024;charSprite.position.y=400;GAME.stage.addChild(charSprite)}that.animate=function(){};that.exit=function(){GAME.stage.removeChild(charSprite)};function debug(){}return that}());GAME.addScreen("zone3",function(){var descriptions={};that={background:{img:"img/"},sprites:[],hotspots:[]};var storyLines={start:{line:""}};that.init=function(){GAME.showStory(storyLines,function(){})};that.animate=function(){};that.exit=function(){};function debug(){}return that}());